<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tienda Energ√≠a 24/7</title>
  <meta name="description" content="Tienda de productos el√©ctricos y solares con entrega inmediata.">
  <meta name="keywords" content="panel solar, inversor, bater√≠a, energ√≠a solar, energ√≠a 24/7">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <header>
    <h1>Tienda Energ√≠a 24/7</h1>
    <input type="text" id="searchInput" placeholder="Buscar producto, marca o categor√≠a..." />
  </header>

  <main>
    <div id="productContainer" class="product-grid"></div>
  </main>

  <footer>
    <p>¬© 2025 Energ√≠a 24/7 - Todos los derechos reservados</p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4CQDWoqsX_jruiEkAQ5ONE_BkXKYl0Jb04_8nmZtyi4SxLN2AyqxB9a-_g3NfFr3IrbRt4VLjcOeP/pub?output=csv";
    const container = document.getElementById("productContainer");
    const searchInput = document.getElementById("searchInput");
    let allProducts = [];

    function slugify(text) {
      return text
        .toString()
        .toLowerCase()
        .trim()
        .replace(/\s+/g, "-")
        .replace(/[^\w\-]+/g, "")
        .replace(/\-\-+/g, "-");
    }

    function renderProducts(products) {
      container.innerHTML = "";
      if (products.length === 0) {
        container.innerHTML = "<p>No se encontraron productos.</p>";
        return;
      }
      products.forEach(row => {
        const nombre = row["Nombre"] || "";
        const categoria = row["Categoria"] || "";
        const marca = row["Marca"] || "";
        const precio = row["Precio"] || "";
        const imagen = row["Imagen"] || "placeholder.jpg";

        const productHTML = `
          <div class="product-card">
            <img src="${imagen}" alt="${nombre}">
            <h3>${nombre}</h3>
            <p><strong>Marca:</strong> ${marca}</p>
            <p><strong>Categor√≠a:</strong> ${categoria}</p>
            <p><strong>Precio:</strong> $${precio}</p>
            <a href="producto.html?item=${encodeURIComponent(slugify(nombre))}" class="button">Ver m√°s</a>
          </div>
        `;
        container.innerHTML += productHTML;
      });
    }

    function loadProducts() {
      Papa.parse(sheetURL, {
        download: true,
        header: true,
        complete: function (results) {
          allProducts = results.data.filter(row => row["Nombre"]);
          renderProducts(allProducts);
        }
      });
    }

    // üîç Search filter
    searchInput.addEventListener("input", (e) => {
      const term = e.target.value.toLowerCase();
      const filtered = allProducts.filter(p =>
        (p["Nombre"] || "").toLowerCase().includes(term) ||
        (p["Marca"] || "").toLowerCase().includes(term) ||
        (p["Categoria"] || "").toLowerCase().includes(term)
      );
      renderProducts(filtered);
    });

    // Initial load
    loadProducts();
  </script>
</body>
</html>
